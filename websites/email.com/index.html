<link href="https://fonts.googleapis.com/css2?family=Crete+Round:ital@1&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://quewon.github.io/necromancy_club/global.css">

<style>
	.email {
		border: 1px solid var(--secondary);
		margin-bottom: var(--font-size);
		padding: var(--font-size);
	}
	#header {
		top: 0;
		padding: var(--font-size);
		border-bottom: 1px solid var(--secondary);
		margin-bottom: var(--font-size);
		width: calc(100% - 3 * var(--font-size));
		position: fixed;
	}
	.inputbar {
		position: relative;
		display: inline-block;
		float: right;
	}

	#container {
		top: calc(4 * var(--font-size));
		position: absolute;
		width: calc(100% - var(--font-size));
	}

	.icon {
		position: absolute;
		width: calc(4*var(--font-size));
		height: calc(4*var(--font-size));
		right: 1;
		top: 1;
		/*
		filter: gray;
		-webkit-filter: grayscale(1);
		filter: grayscale(1);
		*/
	}

	#inbox {
		margin:0;
		display:inline;
	}
	#inbox:hover {
		cursor: pointer;
	}

	#mail_window {
		border: 1px dotted var(--primary);
	}
	#mail_header {
		border-bottom: 1px solid var(--primary);
		margin-bottom: var(--font-size);
	}
	#mail_content, #mail_header {
		padding: var(--font-size);
	}
</style>

<body>
	<div id="header">
		<p id="inbox" onclick="print_all_mail()">inbox</p>
		<div class="inputbar">
			<input id="search" contenteditable spellcheck="false" placeholder="search mail" autocomplete="off"></input><button onclick="check_input()">go!</button>
		</div>
	</div>
	<div id="container">
		<div id="mail_window">
			<div id="mail_header"></div>
			<div id="mail_content"></div>
		</div>

		<div id="inbox_window">
		</div>
	</div>
</body>

<script>
	var inbox_window = document.getElementById("inbox_window");
	var mail_window = document.getElementById("mail_window");
	var mail_header = document.getElementById("mail_header");
	var mail_content = document.getElementById("mail_content");
	function print_all_mail() {
		inbox_window.style.display = 'block';
		mail_window.style.display = 'none';

		let mail = parent.mail.inbox;
		for (let i=mail.length-1; i=0; i--) {
			var div = document.createElement("div");
			div.className = "email";

			let img = new Image(100,100);
			img.src = mail[i].sender_icon;
			img.className = "icon";
			div.appendChild(img);

			div.innerHTML += `<a onclick="show('` + i + `')">`+ mail[i].title + `</a><br />` + mail[i].sender;
			inbox_window.appendChild(div)
		}
	}

	function show(i) {
		inbox_window.style.display = 'none';
		mail_window.style.display = 'block';

		let mail = parent.mail.inbox[i];
		mail_header.innerHTML = mail.title + "<br />" + mail.sender + " [" + mail.sender_address + "]";
		mail_content.innerHTML = mail.content;
	}

	print_all_mail()
</script>